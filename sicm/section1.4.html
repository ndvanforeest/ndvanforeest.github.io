<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Section 1.4</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="/css/tufte.css" type="text/css" />
<link rel="stylesheet" href="/css/ox-tufte.css" type="text/css" />
<link rel="stylesheet" href="/css/pygments.css" type="text/css" />
          <style>
          /* From: https://endlessparentheses.com/public/css/endless.css */
          /* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */
          kbd
          {
            -moz-border-radius: 6px;
            -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            -webkit-border-radius: 6px;
            -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            background-color: #f7f7f7;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            color: #333;
            display: inline-block;
            font-family: 'Droid Sans Mono', monospace;
            font-size: 80%;
            font-weight: normal;
            line-height: inherit;
            margin: 0 .1em;
            padding: .08em .4em;
            text-shadow: 0 1px 0 #fff;
            word-spacing: -4px;
        
            box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */
          }
          </style>
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css"/>
        
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css" />
        
          <script type="text/javascript">
              if (typeof jQuery == 'undefined') {
                  document.write(unescape('%3Cscript src="https://code.jquery.com/jquery-1.10.0.min.js"%3E%3C/script%3E'));
              }
          </script>
        
           <script type="text/javascript"            src="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js"></script>
        
            <script>
                   $(document).ready(function() {
                       $('.tooltip').tooltipster({
                           theme: 'tooltipster-punk',
                           contentAsHTML: true,
                           animation: 'grow',
                           delay: [100,500],
                           // trigger: 'click'
                           trigger: 'custom',
                           triggerOpen: {
                               mouseenter: true
                           },
                           triggerClose: {
                               originClick: true,
                               scroll: true
                           }
           });
                   });
               </script>
        
          <style>
             abbr {color: red;}
        
             .tooltip { border-bottom: 1px dotted #000;
                        color:red;
                        text-decoration: none;}
          </style>
<script>
  window.MathJax = {
    tex: {
      macros: {
        argmin: ["\\mathop{\\mathrm{arg\\,min}}", 0],
        argmax: ["\\mathop{\\mathrm{arg\\,max}}", 0],
        abs: ["\\left\\vert#1\\right\\vert", 1],
        given: ["\\,\\middle|\\,", 0],
        mineq: "\\mathrel{-}=",
        pluseq: "\\mathrel{+}=",
        supp: ["\\mathrm{supp}\\left(#1\\right)", 1],
        B: "\\mathbb{B}",
        C: "\\mathcal{C}",
        d: "\\,\\textrm{d}",
        E: ["\\mathsf{E}\\left[#1\\right]", 1],
        F: "\\mathcal{F}",
        N: "\\mathbb{N}",
        P: ["\\mathsf{P}\\left\\{#1\\right\\}", 1],
        R: "\\mathbb{R}",
        V: ["\\mathsf{V}\\left[#1\\right]", 1],
        Z: "\\mathbb{Z}",
        Bin: ["\\mathrm{Bin}(#1)", 1],
        Exp: ["\\mathrm{Exp}(#1)", 1],
        FS: ["\\mathrm{FS}(#1)", 1],
        Gamm: ["\\mathrm{Gamm}(#1)", 1],
        Geo: ["\\mathrm{Geo}(#1)", 1],
        HGeom: ["\\mathrm{HGeom}(#1)", 1],
        Norm: ["\\mathrm{Norm}(#1)", 1],
        Pois: ["\\mathrm{Pois}(#1)", 1],
        Unif: ["\\mathrm{Unif}(#1)", 1],
        "1": ["\\mathbb{1}\\left\\{#1\\right\\}", 1],
      },
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>
<script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
<header id="preamble" class="status">
<header class='site-header'>
  <div class='site-header-container'>
    <a href="https://ndvanforeest.github.io/">
    <img src="/img/harry.jpg" alt='parsec logo' class='site-logo'>
    </a>
      <div class='site-title-container'>
        <h1 class='site-title'>Nicky&rsquo;s site</h1>
      </div>
    </div>
</header>
<hr class='menu-divider'>
<nav class='menu'>
  <ul>
    <li><a href='/index.html'>Home</a></li>
    <li><a href='/about_this_site.html'>About this site</a></li>
    <li><a href='/bio.html'>Bio</a></li>
    <li><a href='/books.html'>Books</a></li>
  </ul>
</nav>
<hr class='menu-divider'>
</header>
<article id="content" class="content">
<header>
<h1 class="title">Section 1.4</h1>
</header><section id="outline-container-org9beed48" class="outline-2">
<h2 id="org9beed48"><span class="section-number-2">1.</span> Computing Actions</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org7f16d57" class="outline-3">
<h3 id="org7f16d57"><span class="section-number-3">1.1.</span> Standard setup</h3>
<div class="outline-text-3" id="text-1-1">
<p>
I create an Org file for each separate section of the book; for this section it&rsquo;s <code>section1.4.org</code>.
Code that is useful for later sections is tangled to <code>utils1.4.sage</code> and otherwise to <code>section1.4.sage</code>.
This allows me to run the sage scripts on the prompt.
Note that the titles of the  code blocks correspond to the file to which the code is written when tangled.
</p>



<div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">load</span><span class="p">(</span><span class="s2">&quot;functions.sage&quot;</span><span class="p">,</span> <span class="s2">&quot;differentiation.sage&quot;</span><span class="p">,</span> <span class="s2">&quot;tuples.sage&quot;</span><span class="p">)</span>
</pre></div>

<p>
BTW, don&rsquo;t do <code>from sage.all import *</code> because that will lead to name space conflicts, for instance with the <code>Gamma</code> function which we define below.
</p>


<div class="highlight"><pre><span></span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;utils1.4.sage&quot;</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;real&quot;</span><span class="p">)</span>
</pre></div>

<p>
The next module is used for nice printing in org mode files; it should only be loaded in org mode files.
</p>
<div class="highlight"><pre><span></span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;show_expression.sage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div id="outline-container-org99c01cb" class="outline-3">
<h3 id="org99c01cb"><span class="section-number-3">1.2.</span> The Lagrangian for a free particle.</h3>
<div class="outline-text-3" id="text-1-2">
<p>
The function <code>L_free_particle</code> takes <code>mass</code> as an argument and returns the (curried) function <code>Lagrangian</code> that takes a <code>local</code> tuple as an argument.
</p>
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">L_free_particle</span><span class="p">(</span><span class="n">mass</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Lagrangian</span><span class="p">(</span><span class="n">local</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">velocity</span><span class="p">(</span><span class="n">local</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">mass</span> <span class="o">*</span> <span class="n">square</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Lagrangian</span>
</pre></div>

<p>
For the next step, we need a <i>literal functions</i> and <i>coordinate paths</i>.
</p>
</div>
</div>
<div id="outline-container-orgd98eb26" class="outline-3">
<h3 id="orgd98eb26"><span class="section-number-3">1.3.</span> Literal functions</h3>
<div class="outline-text-3" id="text-1-3">
<p>
A <code>literal_function</code> maps the time \(t\) to a coordinate or velocity component of the path, for instance, \(t \to x(t)\).
Since we need to perform arithmetic with literal functions, see below for some examples, we encapsulate it in a <code>Function</code>.
</p>
<div class="highlight"><pre><span></span><span class="nd">@Func</span>
<span class="k">def</span><span class="w"> </span><span class="nf">literal_function</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">function</span><span class="p">(</span><span class="n">name</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
</pre></div>

<p>
It&rsquo;s a function.
</p>
<div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

<pre class="example">
&lt;__main__.Function object at 0x71122066e470&gt;
</pre>


<p>
Here are some operations on <code>x</code>.
</p>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">show</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="n">x</span><span class="p">)(</span><span class="n">t</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">)(</span><span class="n">t</span><span class="p">))</span>
</pre></div>

<p>
Note that, to keep the notation brief, the \(t\) is suppressed in the LaTeX output.
</p>
</div>
</div>
<div id="outline-container-org7925b9e" class="outline-3">
<h3 id="org7925b9e"><span class="section-number-3">1.4.</span> Paths</h3>
<div class="outline-text-3" id="text-1-4">
<p>
We will represent coordinate path functions \(q\) and velocity path functions \(v\) as functions that map time to vectors.
Thus, <code>column_path</code> returns a function of time, not yet a path.
We also need to perform arithmetic on paths, like \(3 q\), therefore we encapsulate the path in a <code>Function</code>.
</p>
<div class="highlight"><pre><span></span><span class="nd">@Func</span>
<span class="k">def</span><span class="w"> </span><span class="nf">column_path</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">column_matrix</span><span class="p">([</span><span class="n">l</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">])</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">column_path</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span>
        <span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>


<p>
Here is an example to see how to use <code>q</code>.
</p>
<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">q</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>

\begin{align}
\left[\begin{array}{c}
x \\
y
\end{array}\right]
\end{align}


<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">((</span><span class="n">q</span> <span class="o">+</span> <span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">((</span><span class="n">q</span> <span class="o">*</span> <span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgee35afe" class="outline-3">
<h3 id="orgee35afe"><span class="section-number-3">1.5.</span> Gamma function</h3>
<div class="outline-text-3" id="text-1-5">
<p>
The Gamma function lifts a coordinate path to a function that maps time to a local tuple of the form \((t, q(t), v(t), \ldots)\).
That is,
</p>
\begin{align*}
\Gamma[q](\cdot) &= (\cdot, q(\cdot), v(\cdot), \ldots), \\
\Gamma[q](t) &= (t, q(t), v(t), \ldots).
\end{align*}
<p>
To follow the conventions of the book, we use an <code>up</code> tuple for <code>Gamma</code>.
However, I don&rsquo;t build the coordinate path nor the velocity as up tuples because I find Sagemath vectors more convenient.
</p>

<p>
\(\Gamma\) just receives \(q\) as an argument. Then it computes the velocity \(v=Dq\), from which the acceleration follows recursively as \(a=D v\), \ldots.
Recall that <code>D</code> computes the derivative (wrt time) of a function that depends on time.
</p>

<p>
When \(n=3\), it returns a function of time that produces the first three elements of the local tuple \((t, q(t), v(t)\).
This is the default.
Once all derivatives are computed, we convert the result to a function that maps time to an up tuple.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;n must be &gt; 1&quot;</span><span class="p">)</span>
    <span class="n">Dq</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">Dq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">Dq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">up</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">*</span><span class="p">[</span><span class="n">v</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">Dq</span><span class="p">])</span>
</pre></div>


<p>
When applying <code>Gamma</code> to a path, we get this.
</p>
<div class="highlight"><pre><span></span><span class="n">local</span> <span class="o">=</span> <span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">local</span><span class="p">)</span>
</pre></div>

<p>
We can include the acceleration too.
</p>
<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">4</span><span class="p">)(</span><span class="n">t</span><span class="p">))</span>
</pre></div>

<p>
Finally, here are some projections operators from the local tuple to supspaces.
</p>
<div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="k">lambda</span> <span class="n">local</span><span class="p">:</span> <span class="n">local</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">coordinate</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="k">lambda</span> <span class="n">local</span><span class="p">:</span> <span class="n">local</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">velocity</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="k">lambda</span> <span class="n">local</span><span class="p">:</span> <span class="n">local</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">compose</span><span class="p">(</span><span class="n">velocity</span><span class="p">,</span> <span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">))(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div id="outline-container-org0ce0959" class="outline-3">
<h3 id="org0ce0959"><span class="section-number-3">1.6.</span> Continuation with the free particle.</h3>
<div class="outline-text-3" id="text-1-6">
<p>
Now we know how to build literal functions and \(\Gamma\), we can continue with the Lagrangian of the free particle.
</p>


<div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">column_path</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span>
        <span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">),</span>
        <span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">q</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">))</span>
</pre></div>

<p>
The Lagrangian of a free particle with mass \(m\) applied to the path <code>Gamma</code> gives this.
Our first implementation is like this: \(L(\Gamma[q](t))\), that is, \(\Gamma[q](t)\) makes a local tuple, and this is given as argument to \(L\).
</p>
<div class="highlight"><pre><span></span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;functions.sage&quot;</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">L_free_particle</span><span class="p">(</span><span class="n">m</span><span class="p">)(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>

<p>
Here is the implementation of the book: \((L\circ \Gamma[q])(t)\), that is, \(L\circ \Gamma[q]\) is a function that depends on \(t\).
Note how the brackets are placed after <code>Gamma(q)</code>.
</p>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">compose</span><span class="p">(</span><span class="n">L_free_particle</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">))(</span><span class="n">t</span><span class="p">))</span>
</pre></div>

<p>
We now compute the integral of Lagrangian <code>L</code> along the path <code>q</code>, but for this we need a function to carry out 1D integration (along time in our case).
Of course, Sagemath already supports a definite integral in a library.
</p>
<div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sage.symbolic.integration.integral</span><span class="w"> </span><span class="kn">import</span> <span class="n">definite_integral</span>
</pre></div>

<p>
I don&rsquo;t like to read \(d t\) at the end of the integral because \(d t\) reads like the product of the variables \(d\) and \(t\).
Instead, I prefer to read \(\d t\); for this reason I overwrite the LaTeX formatting of <code>definite_integral</code>.
</p>
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">integral_latex_format</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">expr</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">args</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="sa">fr</span><span class="s2">&quot;\int_</span><span class="se">{{</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="se">}}</span><span class="s2">^</span><span class="se">{{</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="se">}}</span><span class="s2"> &quot;</span>
        <span class="o">+</span> <span class="n">latex</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
        <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\, \textrm</span><span class="si">{d}</span><span class="s2">\,&quot;</span>
        <span class="o">+</span> <span class="n">latex</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="p">)</span>


<span class="n">definite_integral</span><span class="o">.</span><span class="n">_print_latex_</span> <span class="o">=</span> <span class="n">integral_latex_format</span>
</pre></div>


<p>
Here is the action along a generic path <code>q</code>.
</p>
<div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;positive&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">Lagrangian_action</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">definite_integral</span><span class="p">(</span><span class="n">compose</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">))(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>

<span class="n">show</span><span class="p">(</span><span class="n">Lagrangian_action</span><span class="p">(</span><span class="n">L_free_particle</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">q</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">))</span>
</pre></div>

<p>
To get a numerical answer, we take the test path of the book.
Below we&rsquo;ll do some arithmetic with <code>test_path</code>; therefore we encapsulate it in a <code>Function</code>.
</p>
<div class="highlight"><pre><span></span><span class="n">test_path</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">vector</span><span class="p">([</span><span class="mi">4</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span>
<span class="n">show</span><span class="p">(</span><span class="n">Lagrangian_action</span><span class="p">(</span><span class="n">L_free_particle</span><span class="p">(</span><span class="n">mass</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="n">test_path</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>

<p>
Let&rsquo;s try a harder path. We don&rsquo;t need this later, so the encapsulation in <code>Function</code> is not necessary.
</p>
<div class="highlight"><pre><span></span><span class="n">hard_path</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">vector</span><span class="p">([</span><span class="mi">4</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">Lagrangian_action</span><span class="p">(</span><span class="n">L_free_particle</span><span class="p">(</span><span class="n">mass</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="n">hard_path</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</pre></div>

<p>
The value of the integral is different from \(435\) because the end points of this harder path are not the same as the end points of the test path.
</p>
</div>
</div>
<div id="outline-container-org9639605" class="outline-3">
<h3 id="org9639605"><span class="section-number-3">1.7.</span> Path of minimum action</h3>
<div class="outline-text-3" id="text-1-7">
<p>
First some experiments to see whether my code works as intended.
</p>
<div class="highlight"><pre><span></span><span class="nd">@Func</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_eta</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">):</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">t1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="n">nu</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>


<span class="n">nu</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">vector</span><span class="p">([</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span> <span class="o">^</span> <span class="mi">2</span><span class="p">]))</span>

<span class="n">show</span><span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">make_eta</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="o">+</span> <span class="n">test_path</span><span class="p">)(</span><span class="n">t</span><span class="p">))</span>
</pre></div>

<p>
In the next code, I add the <code>n()</code> to force the result to a floating point number.
(Without this, the result is a long expression with lots of cosines and sines.)
</p>

<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">varied_free_particle_action</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">):</span>
    <span class="n">eta</span> <span class="o">=</span> <span class="n">make_eta</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">eps</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Lagrangian_action</span><span class="p">(</span><span class="n">L_free_particle</span><span class="p">(</span><span class="n">mass</span><span class="p">),</span> <span class="n">q</span> <span class="o">+</span> <span class="n">eps</span> <span class="o">*</span> <span class="n">eta</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">f</span>

<span class="n">show</span><span class="p">(</span><span class="n">varied_free_particle_action</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">test_path</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)(</span><span class="mf">0.001</span><span class="p">))</span>
</pre></div>

<p>
By comparing our result with that of the book, we see we are still on track.
</p>

<p>
Now use Sagemath&rsquo;s <code>find_local_minimum</code> to minimize over \(\epsilon\).
</p>
<div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">find_local_minimum</span><span class="p">(</span>
    <span class="n">varied_free_particle_action</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">test_path</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>

<p>
We see that the optimal value for \(\epsilon\) is \(0\), and we retrieve our earlier value of the Lagrangian action.
</p>
</div>
</div>
<div id="outline-container-orgb948b55" class="outline-3">
<h3 id="orgb948b55"><span class="section-number-3">1.8.</span> Finding minimal trajectories</h3>
<div class="outline-text-3" id="text-1-8">
<p>
The <code>make_path</code> function uses a Lagrangian polynomial to interpolate a given set of data.
</p>
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">Lagrangian_polynomial</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">qs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">RR</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lagrange_polynomial</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">qs</span><span class="p">)))</span>
</pre></div>

<p>
While a Lagrangian polynomial gives an excellent fit on the fitted points, its behavior in between these points can be quite wild.
Let us test the quality of the fit before using this interpolation method.
From the book we know we need to fit \(\cos(t)\) on \(t \in [0, \pi/2]\), so let us try this first before trying to find the optimal path for the harmonic Lagrangian.
Since \(\cos^{2} x + \sin^{2} x = 1\), we can use  this relation to check the quality of derivative of the fitted polynomial at the same time.
The result is better than I expected.
</p>

<div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">qs</span> <span class="o">=</span> <span class="p">[</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">()</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ts</span><span class="p">]</span>
<span class="n">lp</span> <span class="o">=</span> <span class="n">Lagrangian_polynomial</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">qs</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">Cos</span> <span class="o">=</span> <span class="p">[</span><span class="n">lp</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">()</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ts</span><span class="p">]</span>
<span class="n">Sin</span> <span class="o">=</span> <span class="p">[</span><span class="n">lp</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)(</span><span class="n">x</span><span class="o">=</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">()</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ts</span><span class="p">]</span>
<span class="n">Zero</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">Cos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">Sin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">))]</span>
<span class="n">show</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">Zero</span><span class="p">))</span>
</pre></div>

<p>
In the function <code>make_path</code> we use numpy&rsquo;s <code>linspace</code> instead of the linear interpolants of the book.
Note that  the coordinate paths above are column-vector functions, so <code>make_path</code> should return the same type.
</p>
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">make_path</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">qs</span><span class="p">):</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">qs</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">qs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span> <span class="n">qs</span><span class="p">,</span> <span class="n">q1</span><span class="p">]</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">vector</span><span class="p">([</span><span class="n">Lagrangian_polynomial</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">qs</span><span class="p">)(</span><span class="n">t</span><span class="p">)])</span>
</pre></div>

<p>
Here is the harmonic Lagrangian.
</p>
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">L_harmonic</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Lagrangian</span><span class="p">(</span><span class="n">local</span><span class="p">):</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">coordinate</span><span class="p">(</span><span class="n">local</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">velocity</span><span class="p">(</span><span class="n">local</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">square</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="n">square</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Lagrangian</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">parametric_path_action</span><span class="p">(</span><span class="n">Lagrangian</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">qs</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">make_path</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">qs</span><span class="o">=</span><span class="n">qs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Lagrangian_action</span><span class="p">(</span><span class="n">Lagrangian</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">f</span>
</pre></div>

<p>
Let&rsquo;s try this on the path \(\cos(t)\).
The intermediate values <code>qs</code> will be optimized below, whereas <code>q0</code> and <code>q1</code> remain fixed.
Thus, we strip the first and last element of <code>linspace</code> to make <code>qs</code>.
The result tells us what we can expect for the minimal value for the integral over the Lagrangian along the optimal path.
</p>

<div class="highlight"><pre><span></span><span class="n">t0</span><span class="p">,</span> <span class="n">t1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">q0</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">t0</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">initial_qs</span> <span class="o">=</span> <span class="p">[</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">()</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">T</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">parametric_path_action</span><span class="p">(</span><span class="n">L_harmonic</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">t0</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">q1</span><span class="p">)(</span><span class="n">initial_qs</span><span class="p">)</span>
</pre></div>

<p>
What is the quality of the path obtained by the Lagrangian interpolation?
(Recall that a path is a vector; to extract the value of the element that corresponds to the path, we need to write <code>best_path(t=t)[0]</code>.)
</p>
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">find_path</span><span class="p">(</span><span class="n">Lagrangian</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">initial_qs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">n</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">minimizing_qs</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
        <span class="n">parametric_path_action</span><span class="p">(</span><span class="n">Lagrangian</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">q1</span><span class="p">),</span>
        <span class="n">initial_qs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">make_path</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">minimizing_qs</span><span class="p">)</span>

<span class="n">best_path</span> <span class="o">=</span> <span class="n">find_path</span><span class="p">(</span><span class="n">L_harmonic</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">q0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">t1</span><span class="o">=</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">q1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">best_path</span><span class="p">(</span><span class="n">t</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n</span><span class="p">()</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">())</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">show</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</pre></div>

<p>
Great. All works!
</p>

<p>
Finally, here is a plot of the Lagrangian as a function of \(q(t)\).
</p>


<div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">vector</span><span class="p">([</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>
<span class="n">lvalues</span> <span class="o">=</span> <span class="p">[</span><span class="n">L_harmonic</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">))(</span><span class="n">t</span><span class="o">=</span><span class="n">ti</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">()</span> <span class="k">for</span> <span class="n">ti</span> <span class="ow">in</span> <span class="n">T</span><span class="p">]</span>
<span class="n">points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">lvalues</span><span class="p">))</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">list_plot</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">axes_labels</span><span class="p">([</span><span class="s2">&quot;$t$&quot;</span><span class="p">,</span> <span class="s2">&quot;$L$&quot;</span><span class="p">])</span>
<span class="n">plot</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;../figures/Lagrangian.png&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>


<figure id="org7f6f53b">
<img src="././../figures/Lagrangian.png" alt="Lagrangian.png">

<figcaption><span class="figure-number">Figure 1: </span>The harmonic Lagrangian as a function of the optimal path \(q(t)=\cos t\), \(t \in [0, \pi/2]\).</figcaption>
</figure>
</div>
</div>
</section>
</article>
<footer id="postamble" class="status">
<hr> <p class="footer"> &#8226; A site by Nicky van Foreest &#8226;   Last updated: , Generated with <a href="https://www.gnu.org/software/emacs/">Emacs</a> 30.1 (<a href="https://orgmode.org">Org</a> mode 9.7.11)</p>
</footer>
</body>
</html>
