<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Section 1.5</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="/css/tufte.css" type="text/css" />
<link rel="stylesheet" href="/css/ox-tufte.css" type="text/css" />
<link rel="stylesheet" href="/css/pygments.css" type="text/css" />
          <style>
          /* From: https://endlessparentheses.com/public/css/endless.css */
          /* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */
          kbd
          {
            -moz-border-radius: 6px;
            -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            -webkit-border-radius: 6px;
            -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            background-color: #f7f7f7;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            color: #333;
            display: inline-block;
            font-family: 'Droid Sans Mono', monospace;
            font-size: 80%;
            font-weight: normal;
            line-height: inherit;
            margin: 0 .1em;
            padding: .08em .4em;
            text-shadow: 0 1px 0 #fff;
            word-spacing: -4px;
        
            box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */
          }
          </style>
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css"/>
        
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css" />
        
          <script type="text/javascript">
              if (typeof jQuery == 'undefined') {
                  document.write(unescape('%3Cscript src="https://code.jquery.com/jquery-1.10.0.min.js"%3E%3C/script%3E'));
              }
          </script>
        
           <script type="text/javascript"            src="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js"></script>
        
            <script>
                   $(document).ready(function() {
                       $('.tooltip').tooltipster({
                           theme: 'tooltipster-punk',
                           contentAsHTML: true,
                           animation: 'grow',
                           delay: [100,500],
                           // trigger: 'click'
                           trigger: 'custom',
                           triggerOpen: {
                               mouseenter: true
                           },
                           triggerClose: {
                               originClick: true,
                               scroll: true
                           }
           });
                   });
               </script>
        
          <style>
             abbr {color: red;}
        
             .tooltip { border-bottom: 1px dotted #000;
                        color:red;
                        text-decoration: none;}
          </style>
          
          <style>
          /* From: https://endlessparentheses.com/public/css/endless.css */
          /* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */
          kbd
          {
            -moz-border-radius: 6px;
            -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            -webkit-border-radius: 6px;
            -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            background-color: #f7f7f7;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            color: #333;
            display: inline-block;
            font-family: 'Droid Sans Mono', monospace;
            font-size: 80%;
            font-weight: normal;
            line-height: inherit;
            margin: 0 .1em;
            padding: .08em .4em;
            text-shadow: 0 1px 0 #fff;
            word-spacing: -4px;
        
            box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */
          }
          </style>
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css"/>
        
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css" />
        
          <script type="text/javascript">
              if (typeof jQuery == 'undefined') {
                  document.write(unescape('%3Cscript src="https://code.jquery.com/jquery-1.10.0.min.js"%3E%3C/script%3E'));
              }
          </script>
        
           <script type="text/javascript"            src="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js"></script>
        
            <script>
                   $(document).ready(function() {
                       $('.tooltip').tooltipster({
                           theme: 'tooltipster-punk',
                           contentAsHTML: true,
                           animation: 'grow',
                           delay: [100,500],
                           // trigger: 'click'
                           trigger: 'custom',
                           triggerOpen: {
                               mouseenter: true
                           },
                           triggerClose: {
                               originClick: true,
                               scroll: true
                           }
           });
                   });
               </script>
        
          <style>
             abbr {color: red;}
        
             .tooltip { border-bottom: 1px dotted #000;
                        color:red;
                        text-decoration: none;}
          </style>
          
          <style>
          /* From: https://endlessparentheses.com/public/css/endless.css */
          /* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */
          kbd
          {
            -moz-border-radius: 6px;
            -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            -webkit-border-radius: 6px;
            -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            background-color: #f7f7f7;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            color: #333;
            display: inline-block;
            font-family: 'Droid Sans Mono', monospace;
            font-size: 80%;
            font-weight: normal;
            line-height: inherit;
            margin: 0 .1em;
            padding: .08em .4em;
            text-shadow: 0 1px 0 #fff;
            word-spacing: -4px;
        
            box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */
          }
          </style>
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css"/>
        
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css" />
        
          <script type="text/javascript">
              if (typeof jQuery == 'undefined') {
                  document.write(unescape('%3Cscript src="https://code.jquery.com/jquery-1.10.0.min.js"%3E%3C/script%3E'));
              }
          </script>
        
           <script type="text/javascript"            src="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js"></script>
        
            <script>
                   $(document).ready(function() {
                       $('.tooltip').tooltipster({
                           theme: 'tooltipster-punk',
                           contentAsHTML: true,
                           animation: 'grow',
                           delay: [100,500],
                           // trigger: 'click'
                           trigger: 'custom',
                           triggerOpen: {
                               mouseenter: true
                           },
                           triggerClose: {
                               originClick: true,
                               scroll: true
                           }
           });
                   });
               </script>
        
          <style>
             abbr {color: red;}
        
             .tooltip { border-bottom: 1px dotted #000;
                        color:red;
                        text-decoration: none;}
          </style>
          
          <style>
          /* From: https://endlessparentheses.com/public/css/endless.css */
          /* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */
          kbd
          {
            -moz-border-radius: 6px;
            -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            -webkit-border-radius: 6px;
            -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            background-color: #f7f7f7;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            color: #333;
            display: inline-block;
            font-family: 'Droid Sans Mono', monospace;
            font-size: 80%;
            font-weight: normal;
            line-height: inherit;
            margin: 0 .1em;
            padding: .08em .4em;
            text-shadow: 0 1px 0 #fff;
            word-spacing: -4px;
        
            box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */
          }
          </style>
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css"/>
        
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css" />
        
          <script type="text/javascript">
              if (typeof jQuery == 'undefined') {
                  document.write(unescape('%3Cscript src="https://code.jquery.com/jquery-1.10.0.min.js"%3E%3C/script%3E'));
              }
          </script>
        
           <script type="text/javascript"            src="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js"></script>
        
            <script>
                   $(document).ready(function() {
                       $('.tooltip').tooltipster({
                           theme: 'tooltipster-punk',
                           contentAsHTML: true,
                           animation: 'grow',
                           delay: [100,500],
                           // trigger: 'click'
                           trigger: 'custom',
                           triggerOpen: {
                               mouseenter: true
                           },
                           triggerClose: {
                               originClick: true,
                               scroll: true
                           }
           });
                   });
               </script>
        
          <style>
             abbr {color: red;}
        
             .tooltip { border-bottom: 1px dotted #000;
                        color:red;
                        text-decoration: none;}
          </style>
          
          <style>
          /* From: https://endlessparentheses.com/public/css/endless.css */
          /* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */
          kbd
          {
            -moz-border-radius: 6px;
            -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            -webkit-border-radius: 6px;
            -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            background-color: #f7f7f7;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            color: #333;
            display: inline-block;
            font-family: 'Droid Sans Mono', monospace;
            font-size: 80%;
            font-weight: normal;
            line-height: inherit;
            margin: 0 .1em;
            padding: .08em .4em;
            text-shadow: 0 1px 0 #fff;
            word-spacing: -4px;
        
            box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */
          }
          </style>
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css"/>
        
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css" />
        
          <script type="text/javascript">
              if (typeof jQuery == 'undefined') {
                  document.write(unescape('%3Cscript src="https://code.jquery.com/jquery-1.10.0.min.js"%3E%3C/script%3E'));
              }
          </script>
        
           <script type="text/javascript"            src="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js"></script>
        
            <script>
                   $(document).ready(function() {
                       $('.tooltip').tooltipster({
                           theme: 'tooltipster-punk',
                           contentAsHTML: true,
                           animation: 'grow',
                           delay: [100,500],
                           // trigger: 'click'
                           trigger: 'custom',
                           triggerOpen: {
                               mouseenter: true
                           },
                           triggerClose: {
                               originClick: true,
                               scroll: true
                           }
           });
                   });
               </script>
        
          <style>
             abbr {color: red;}
        
             .tooltip { border-bottom: 1px dotted #000;
                        color:red;
                        text-decoration: none;}
          </style>
          
          <style>
          /* From: https://endlessparentheses.com/public/css/endless.css */
          /* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */
          kbd
          {
            -moz-border-radius: 6px;
            -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            -webkit-border-radius: 6px;
            -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            background-color: #f7f7f7;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            color: #333;
            display: inline-block;
            font-family: 'Droid Sans Mono', monospace;
            font-size: 80%;
            font-weight: normal;
            line-height: inherit;
            margin: 0 .1em;
            padding: .08em .4em;
            text-shadow: 0 1px 0 #fff;
            word-spacing: -4px;
        
            box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */
          }
          </style>
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css"/>
        
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css" />
        
          <script type="text/javascript">
              if (typeof jQuery == 'undefined') {
                  document.write(unescape('%3Cscript src="https://code.jquery.com/jquery-1.10.0.min.js"%3E%3C/script%3E'));
              }
          </script>
        
           <script type="text/javascript"            src="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js"></script>
        
            <script>
                   $(document).ready(function() {
                       $('.tooltip').tooltipster({
                           theme: 'tooltipster-punk',
                           contentAsHTML: true,
                           animation: 'grow',
                           delay: [100,500],
                           // trigger: 'click'
                           trigger: 'custom',
                           triggerOpen: {
                               mouseenter: true
                           },
                           triggerClose: {
                               originClick: true,
                               scroll: true
                           }
           });
                   });
               </script>
        
          <style>
             abbr {color: red;}
        
             .tooltip { border-bottom: 1px dotted #000;
                        color:red;
                        text-decoration: none;}
          </style>
          
          <style>
          /* From: https://endlessparentheses.com/public/css/endless.css */
          /* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */
          kbd
          {
            -moz-border-radius: 6px;
            -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            -webkit-border-radius: 6px;
            -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            background-color: #f7f7f7;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            color: #333;
            display: inline-block;
            font-family: 'Droid Sans Mono', monospace;
            font-size: 80%;
            font-weight: normal;
            line-height: inherit;
            margin: 0 .1em;
            padding: .08em .4em;
            text-shadow: 0 1px 0 #fff;
            word-spacing: -4px;
        
            box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */
          }
          </style>
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css"/>
        
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css" />
        
          <script type="text/javascript">
              if (typeof jQuery == 'undefined') {
                  document.write(unescape('%3Cscript src="https://code.jquery.com/jquery-1.10.0.min.js"%3E%3C/script%3E'));
              }
          </script>
        
           <script type="text/javascript"            src="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js"></script>
        
            <script>
                   $(document).ready(function() {
                       $('.tooltip').tooltipster({
                           theme: 'tooltipster-punk',
                           contentAsHTML: true,
                           animation: 'grow',
                           delay: [100,500],
                           // trigger: 'click'
                           trigger: 'custom',
                           triggerOpen: {
                               mouseenter: true
                           },
                           triggerClose: {
                               originClick: true,
                               scroll: true
                           }
           });
                   });
               </script>
        
          <style>
             abbr {color: red;}
        
             .tooltip { border-bottom: 1px dotted #000;
                        color:red;
                        text-decoration: none;}
          </style>
          
          <style>
          /* From: https://endlessparentheses.com/public/css/endless.css */
          /* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */
          kbd
          {
            -moz-border-radius: 6px;
            -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            -webkit-border-radius: 6px;
            -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            background-color: #f7f7f7;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            color: #333;
            display: inline-block;
            font-family: 'Droid Sans Mono', monospace;
            font-size: 80%;
            font-weight: normal;
            line-height: inherit;
            margin: 0 .1em;
            padding: .08em .4em;
            text-shadow: 0 1px 0 #fff;
            word-spacing: -4px;
        
            box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */
          }
          </style>
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css"/>
        
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css" />
        
          <script type="text/javascript">
              if (typeof jQuery == 'undefined') {
                  document.write(unescape('%3Cscript src="https://code.jquery.com/jquery-1.10.0.min.js"%3E%3C/script%3E'));
              }
          </script>
        
           <script type="text/javascript"            src="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js"></script>
        
            <script>
                   $(document).ready(function() {
                       $('.tooltip').tooltipster({
                           theme: 'tooltipster-punk',
                           contentAsHTML: true,
                           animation: 'grow',
                           delay: [100,500],
                           // trigger: 'click'
                           trigger: 'custom',
                           triggerOpen: {
                               mouseenter: true
                           },
                           triggerClose: {
                               originClick: true,
                               scroll: true
                           }
           });
                   });
               </script>
        
          <style>
             abbr {color: red;}
        
             .tooltip { border-bottom: 1px dotted #000;
                        color:red;
                        text-decoration: none;}
          </style>
          
          <style>
          /* From: https://endlessparentheses.com/public/css/endless.css */
          /* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */
          kbd
          {
            -moz-border-radius: 6px;
            -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            -webkit-border-radius: 6px;
            -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            background-color: #f7f7f7;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
            color: #333;
            display: inline-block;
            font-family: 'Droid Sans Mono', monospace;
            font-size: 80%;
            font-weight: normal;
            line-height: inherit;
            margin: 0 .1em;
            padding: .08em .4em;
            text-shadow: 0 1px 0 #fff;
            word-spacing: -4px;
        
            box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */
          }
          </style>
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css"/>
        
          <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css" />
        
          <script type="text/javascript">
              if (typeof jQuery == 'undefined') {
                  document.write(unescape('%3Cscript src="https://code.jquery.com/jquery-1.10.0.min.js"%3E%3C/script%3E'));
              }
          </script>
        
           <script type="text/javascript"            src="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js"></script>
        
            <script>
                   $(document).ready(function() {
                       $('.tooltip').tooltipster({
                           theme: 'tooltipster-punk',
                           contentAsHTML: true,
                           animation: 'grow',
                           delay: [100,500],
                           // trigger: 'click'
                           trigger: 'custom',
                           triggerOpen: {
                               mouseenter: true
                           },
                           triggerClose: {
                               originClick: true,
                               scroll: true
                           }
           });
                   });
               </script>
        
          <style>
             abbr {color: red;}
        
             .tooltip { border-bottom: 1px dotted #000;
                        color:red;
                        text-decoration: none;}
          </style>
<script>
  window.MathJax = {
    tex: {
      macros: {
        argmin: ["\\mathop{\\mathrm{arg\\,min}}", 0],
        argmax: ["\\mathop{\\mathrm{arg\\,max}}", 0],
        abs: ["\\left\\vert#1\\right\\vert", 1],
        given: ["\\,\\middle|\\,", 0],
        mineq: "\\mathrel{-}=",
        pluseq: "\\mathrel{+}=",
        supp: ["\\mathrm{supp}\\left(#1\\right)", 1],
        B: "\\mathbb{B}",
        C: "\\mathcal{C}",
        d: "\\,\\textrm{d}",
        E: ["\\mathsf{E}\\left[#1\\right]", 1],
        F: "\\mathcal{F}",
        N: "\\mathbb{N}",
        P: ["\\mathsf{P}\\left\\{#1\\right\\}", 1],
        R: "\\mathbb{R}",
        V: ["\\mathsf{V}\\left[#1\\right]", 1],
        Z: "\\mathbb{Z}",
        Bin: ["\\mathrm{Bin}(#1)", 1],
        Exp: ["\\mathrm{Exp}(#1)", 1],
        FS: ["\\mathrm{FS}(#1)", 1],
        Gamm: ["\\mathrm{Gamm}(#1)", 1],
        Geo: ["\\mathrm{Geo}(#1)", 1],
        HGeom: ["\\mathrm{HGeom}(#1)", 1],
        Norm: ["\\mathrm{Norm}(#1)", 1],
        Pois: ["\\mathrm{Pois}(#1)", 1],
        Unif: ["\\mathrm{Unif}(#1)", 1],
        "1": ["\\mathbb{1}\\left\\{#1\\right\\}", 1],
      },
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>
<script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
<header id="preamble" class="status">
<header class='site-header'>
  <div class='site-header-container'>
    <a href="https://ndvanforeest.github.io/">
    <img src="/img/harry.jpg" alt='parsec logo' class='site-logo'>
    </a>
      <div class='site-title-container'>
        <h1 class='site-title'>Nicky&rsquo;s site</h1>
      </div>
    </div>
</header>
<hr class='menu-divider'>
<nav class='menu'>
  <ul>
    <li><a href='/index.html'>Home</a></li>
    <li><a href='/about_this_site.html'>About this site</a></li>
    <li><a href='/bio.html'>Bio</a></li>
    <li><a href='/books.html'>Books</a></li>
  </ul>
</nav>
<hr class='menu-divider'>
</header>
<article id="content" class="content">
<header>
<h1 class="title">Section 1.5</h1>
</header><section id="outline-container-org7161a33" class="outline-2">
<h2 id="org7161a33"><span class="section-number-2">1.</span> The Euler-Lagrange Equations</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org7f16d57" class="outline-3">
<h3 id="org7f16d57"><span class="section-number-3">1.1.</span> Standard imports</h3>
<div class="outline-text-3" id="text-1-1">
<div class="highlight"><pre><span></span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;utils1.4.sage&quot;</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;utils1.5.sage&quot;</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;real&quot;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;show_expression.sage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div id="outline-container-org7f6f53b" class="outline-3">
<h3 id="org7f6f53b"><span class="section-number-3">1.2.</span> Derivation of the Lagrange equations</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-org99c01cb" class="outline-4">
<h4 id="org99c01cb"><span class="section-number-4">1.2.1.</span> Harmonic oscillator</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
Here is a test on the harmonic oscillator.
</p>
<div class="highlight"><pre><span></span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;utils1.4.sage&quot;</span><span class="p">)</span>
<span class="n">k</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;k m&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;positive&quot;</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">column_path</span><span class="p">([</span><span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)])</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">L_harmonic</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>

<p>
We can apply \(\partial_{1}L\) and \(\partial_{2}L\) to a configuration path \(q\) that we lift to a local tuple by means of \(\Gamma\).
Realize therefore that <code>partial(L_harmonic(m, k), 1)</code> maps a local tuple to a real number, and <code>Gamma(q)</code> maps a time \(t\) to a local tuple.
The next code implements \(\partial_1 L(\Gamma(q)(t))\) and \(\partial_2 L(\Gamma(q)(t))\).
(Check how the brackets are organized.)
</p>
<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="p">)(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">2</span><span class="p">)(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>

<p>
Here are the same results, but now with functional composition.
</p>
\begin{align*}
&\left(\partial_{1} L \circ \Gamma(q)\right)(t), &
&\left(\partial_{2}L \circ \Gamma(q)\right)(t).
\end{align*}
<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">compose</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">))(</span><span class="n">t</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span><span class="n">compose</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">))(</span><span class="n">t</span><span class="p">))</span>
</pre></div>

<p>
These results are functions of \(t\), so we can take the derivative with respect to \(t\), which forms the last step to check before building the Euler-Lagrange equations.
To understand this, note the following function mappings, where we write \(t\) for time, \(l\) for a local tuple, \(v\) a velocity-like vector, and \(a\) an acceleration-like vector:
</p>
\begin{align*}
\Gamma[q]: t &\to l,\\
\partial_{2} L: l &\to v \\
\partial_{2} L \circ \Gamma[q] : t &\to v \\
D(v): t &\to  a\\
D(\partial_{2} L \circ \Gamma[q]) : t &\to a.
\end{align*}
<p>
In more classical notation, we compute this:
</p>
\begin{align*}
\frac{\d}{\d t}\left(\frac{\partial}{\partial_{\dot q}} L\left(\Gamma(q)\right)\right)(t)
\end{align*}


<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">compose</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)))(</span><span class="n">t</span><span class="p">))</span>
</pre></div>

<p>
There we are! We can now try the other examples of the book.
</p>
</div>
</div>
<div id="outline-container-orgd98eb26" class="outline-4">
<h4 id="orgd98eb26"><span class="section-number-4">1.2.2.</span> Orbital motion</h4>
<div class="outline-text-4" id="text-1-2-2">
<div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">column_path</span><span class="p">([</span><span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;xi&quot;</span><span class="p">),</span> <span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;eta&quot;</span><span class="p">)])</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;positive&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">L_orbital</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Lagrangian</span><span class="p">(</span><span class="n">local</span><span class="p">):</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">coordinate</span><span class="p">(</span><span class="n">local</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">velocity</span><span class="p">(</span><span class="n">local</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">square</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="n">mu</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">square</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Lagrangian</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">L_orbital</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="p">)(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">2</span><span class="p">)(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div id="outline-container-org7925b9e" class="outline-4">
<h4 id="org7925b9e"><span class="section-number-4">1.2.3.</span> An ideal planar pendulum,  Exercise 1.9.a of the book</h4>
<div class="outline-text-4" id="text-1-2-3">
<p>
We need a new path in terms of \(\theta\) and \(\dot \theta\).
</p>
<div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">column_path</span><span class="p">([</span><span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;theta&quot;</span><span class="p">)])</span>
</pre></div>

<p>
Here is the Lagrangian.
Recall that the coordinates of the space form a vector.
Here, <code>theta</code> is the only element of the vector, which we can extract by considering element \(0\).
For <code>thetadot</code> we don&rsquo;t have to do this since we consider \(\dot \theta^{2}\), and the <code>square</code> function accepts vectors as input and returns a real.
However, for reasons of consistency, we choose to do this nonetheless.
</p>

<div class="highlight"><pre><span></span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;m g l&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;positive&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">L_planar_pendulum</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Lagrangian</span><span class="p">(</span><span class="n">local</span><span class="p">):</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">coordinate</span><span class="p">(</span><span class="n">local</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">theta_dot</span> <span class="o">=</span> <span class="n">velocity</span><span class="p">(</span><span class="n">local</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">l</span> <span class="o">^</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">square</span><span class="p">(</span><span class="n">theta_dot</span><span class="p">)</span>
        <span class="n">V</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">l</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">T</span> <span class="o">-</span> <span class="n">V</span>

    <span class="k">return</span> <span class="n">Lagrangian</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">L_planar_pendulum</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="p">)(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">2</span><span class="p">)(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgee35afe" class="outline-4">
<h4 id="orgee35afe"><span class="section-number-4">1.2.4.</span> Henon Heiles potential,  Exercise 1.9.b of the book</h4>
<div class="outline-text-4" id="text-1-2-4">
<p>
As the potential depends on the \(x\) and \(y\) coordinate separately, we need to unpack the coordinate vector.
</p>

<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">L_Henon_Heiles</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Lagrangian</span><span class="p">(</span><span class="n">local</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">coordinate</span><span class="p">(</span><span class="n">local</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">velocity</span><span class="p">(</span><span class="n">local</span><span class="p">)</span>
        <span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">square</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">V</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">square</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">+</span> <span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">y</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">3</span>
        <span class="k">return</span> <span class="n">T</span> <span class="o">-</span> <span class="n">V</span>

    <span class="k">return</span> <span class="n">Lagrangian</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">L_Henon_Heiles</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">column_path</span><span class="p">([</span><span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)])</span>
<span class="n">show</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="p">)(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">2</span><span class="p">)(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div id="outline-container-org0ce0959" class="outline-4">
<h4 id="org0ce0959"><span class="section-number-4">1.2.5.</span> Motion on the 2d sphere,  Exercise 1.9.c of the book</h4>
<div class="outline-text-4" id="text-1-2-5">
<div class="highlight"><pre><span></span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;positive&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">L_sphere</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Lagrangian</span><span class="p">(</span><span class="n">local</span><span class="p">):</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">coordinate</span><span class="p">(</span><span class="n">local</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">velocity</span><span class="p">(</span><span class="n">local</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
        <span class="n">L</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="p">(</span><span class="n">square</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">+</span> <span class="n">square</span><span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)))</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="n">L</span>

    <span class="k">return</span> <span class="n">Lagrangian</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">column_path</span><span class="p">([</span><span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;phi&quot;</span><span class="p">),</span> <span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;theta&quot;</span><span class="p">)])</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">L_sphere</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>

<span class="n">show</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="p">)(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">2</span><span class="p">)(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div id="outline-container-org9639605" class="outline-4">
<h4 id="org9639605"><span class="section-number-4">1.2.6.</span> Higher order Lagrangians</h4>
<div class="outline-text-4" id="text-1-2-6">
<p>
I recently read the books of Larry Susskind on the theoretical minimum for physics. He claims that Lagrangians up to first order derivatives suffice to understand nature, so I skip this part.
</p>
</div>
</div>
</div>
<div id="outline-container-orgfa898cb" class="outline-3">
<h3 id="orgfa898cb"><span class="section-number-3">1.3.</span> Computing Lagrange&rsquo;s equation</h3>
<div class="outline-text-3" id="text-1-3">
<p>
The Euler-Lagrange equations are simple to implement now that we have a good function for computing partial derivatives.
</p>
</div>
<div id="outline-container-orgb948b55" class="outline-4">
<h4 id="orgb948b55"><span class="section-number-4">1.3.1.</span> The Euler Lagrange  Equations</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
We work in steps to see how all components tie together.
</p>
<div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">column_path</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span>
        <span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">L</span> <span class="o">=</span> <span class="n">L_free_particle</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">compose</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">))(</span><span class="n">t</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span><span class="n">compose</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">))(</span><span class="n">t</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">compose</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)))(</span><span class="n">t</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span>
    <span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">compose</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span> <span class="o">-</span> <span class="n">compose</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)))(</span><span class="n">t</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

<p>
The last step forms the Euler-Lagrange equation, which we can now implement as a function.
</p>
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">Lagrange_equations</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">D</span><span class="p">(</span><span class="n">compose</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span> <span class="o">-</span> <span class="n">compose</span><span class="p">(</span>
            <span class="n">partial</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">f</span>
</pre></div>
</div>
</div>
<div id="outline-container-org9beed48" class="outline-4">
<h4 id="org9beed48"><span class="section-number-4">1.3.2.</span> The free particle</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
We compute the Lagrange equation for a path linear in \(t\) for the Lagrangian of a free particle..
</p>

<div class="highlight"><pre><span></span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;a b c a0 b0 c0&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;real&quot;</span><span class="p">)</span>
<span class="n">test_path</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">column_matrix</span><span class="p">([</span><span class="n">a</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">a0</span><span class="p">,</span> <span class="n">b</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">b0</span><span class="p">,</span> <span class="n">c</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">c0</span><span class="p">])</span>
</pre></div>

<p>
Note that if we do not provide the argument <code>t</code> to <code>l_eq</code> we receive a function instead of vector.
</p>

<div class="highlight"><pre><span></span><span class="n">l_eq</span> <span class="o">=</span> <span class="n">Lagrange_equations</span><span class="p">(</span><span class="n">L_free_particle</span><span class="p">(</span><span class="n">m</span><span class="p">))(</span><span class="n">test_path</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">l_eq</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>

<p>
This is correct since a free particle is not moving in a potential field, hence only depends on the velocity but not the coordinates of the path. But since the velocity is linear in \(t\), all components along the test path become zero.
</p>


<p>
Here are the EL equations for a generic 1D path.
</p>
<div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">column_path</span><span class="p">([</span><span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)])</span>
<span class="n">l_eq</span> <span class="o">=</span> <span class="n">Lagrange_equations</span><span class="p">(</span><span class="n">L_free_particle</span><span class="p">(</span><span class="n">m</span><span class="p">))(</span><span class="n">q</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">l_eq</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>

<p>
Equating this to \((0)\) shows that the solution of these differential equations is linear in \(t\).
</p>
</div>
</div>
<div id="outline-container-org2dc1f56" class="outline-4">
<h4 id="org2dc1f56"><span class="section-number-4">1.3.3.</span> The harmonic oscillator</h4>
<div class="outline-text-4" id="text-1-3-3">
<div class="highlight"><pre><span></span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;A phi omega&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;real&quot;</span><span class="p">)</span>
<span class="n">assume</span><span class="p">(</span><span class="n">A</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">proposed_path</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">vector</span><span class="p">([</span><span class="n">A</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">omega</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">phi</span><span class="p">)])</span>
</pre></div>


<p>
<code>Lagrange_equations</code> returns a matrix whose elements correspond to the components of the configuration path \(q\).
</p>
<div class="highlight"><pre><span></span><span class="n">l_eq</span> <span class="o">=</span> <span class="n">Lagrange_equations</span><span class="p">(</span><span class="n">L_harmonic</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">))(</span><span class="n">proposed_path</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">l_eq</span><span class="p">)</span>
</pre></div>

<p>
To obtain the contents of this \(1\times 1\) matrix, we take the element <code>[0][0]</code>.
</p>
<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">l_eq</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

<p>
Let&rsquo;s  factor out the cosine.
</p>
<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">l_eq</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">factor</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgde0f8b8" class="outline-4">
<h4 id="orgde0f8b8"><span class="section-number-4">1.3.4.</span> Kepler&rsquo;s third law</h4>
<div class="outline-text-4" id="text-1-3-4">
<p>
Recall that to unpack the coordinates, we have to convert the vector to a Python list.
</p>

<div class="highlight"><pre><span></span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;G m m1 m2&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;positive&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">L_central_polar</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">V</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Lagrangian</span><span class="p">(</span><span class="n">local</span><span class="p">):</span>
        <span class="n">r</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">coordinate</span><span class="p">(</span><span class="n">local</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
        <span class="n">rdot</span><span class="p">,</span> <span class="n">phidot</span> <span class="o">=</span> <span class="n">velocity</span><span class="p">(</span><span class="n">local</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
        <span class="n">T</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="n">square</span><span class="p">(</span><span class="n">rdot</span><span class="p">)</span> <span class="o">+</span> <span class="n">square</span><span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">phidot</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">T</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Lagrangian</span>


<span class="k">def</span><span class="w"> </span><span class="nf">gravitational_energy</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">G</span> <span class="o">*</span> <span class="n">m1</span> <span class="o">*</span> <span class="n">m2</span> <span class="o">/</span> <span class="n">r</span>

    <span class="k">return</span> <span class="n">f</span>
</pre></div>



<div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">column_path</span><span class="p">([</span><span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">),</span> <span class="n">literal_function</span><span class="p">(</span><span class="s2">&quot;phi&quot;</span><span class="p">)])</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">gravitational_energy</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">L_central_polar</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">Gamma</span><span class="p">(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">l_eq</span> <span class="o">=</span> <span class="n">Lagrange_equations</span><span class="p">(</span><span class="n">L</span><span class="p">)(</span><span class="n">q</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">l_eq</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>

<p>
In this equation, let&rsquo;s divide by \(m r\) to get \(r \ddot \phi + 2 \dot \phi \dot r = 0\), which is equal to \(\partial_{t}(\dot \phi r^{2}) = 0\).
This implies that \(\dot \phi r^{2} = C\), i.e., a constant. If \(r\neq 0\) and constant, which we should assume according to the book, then we see that \(\dot \phi\) is constant, so the two bodies rotate with constant angular speed around each other.
</p>


<p>
What can we say about the other equation?
</p>
<div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">l_eq</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>

<p>
As \(r\) is constant according to the book, \(\ddot r = 0\).
By dividing by \(m := m_{1}m_{2}/(m_{1}+m_{2})\), this equation reduces to \(r^{3}\dot \phi^{2} = G(m_{1}+m_{2})\), which is the form we were to find according to the exercise.
</p>
</div>
</div>
</div>
</section>
</article>
<footer id="postamble" class="status">
<hr> <p class="footer"> &#8226; A site by Nicky van Foreest &#8226;   Last updated: , Generated with <a href="https://www.gnu.org/software/emacs/">Emacs</a> 30.1 (<a href="https://orgmode.org">Org</a> mode 9.7.11)</p>
</footer>
</body>
</html>
